


Multimorbidity is defined by the coexistence of multiple health conditions in an individual. 
Medical conditions are usually classified by family, grouped by broad characteristic such as the way they operate or the body part they affect. 
ICD9 REFERENCE

Such classifications are useful for diagnosis, but patients usually suffer from a number of diseases belonging to various families. Moreover they are often interrelated, mutually influencing one an other or with a condition "causing" an other one which can lead to hospitalization, for example obesity greatly increases risks of heart diseases.
REF
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3250069/

These relations of interdependence between vastly different diseases should give rise to an other way to classify diseases, more suited to evaluate their role, if they have any, in multimorbidity.


Following this perspective, a disease can be looked at not only by its characteristic but in the context it occurs in.

And unlike the Elixhauser index, which derives 30 categories of comorbidities from published studies, an other approach would be to derive these categories directly from medical data.
https://www.jstor.org/stable/3766985?seq=1#metadata_info_tab_contents


Building a disease classification independently of the explicit use of their characteristics could allow the inclusion of more various factors. 
Diseases are now characterized by the patients they affect along with their proximity to other diseases.  
This approach is compatible with a network representation, patient nodes being connected to a disease one if they are affected by it.
Given a list of patients with their associated diseases, if the structure of the graph is not random then the connection patterns of the nodes should allow their classification in communities. 

The clusters will comport more densely connected nodes, as there is no edges between diseases, their nodes will be grouped if they share many connections with similar patients.

The goal is thus to obtain a grouping of nodes of diseases given a network derived from medical data. 

The method to evaluate this particular will be the stochastic block model (SBM).

For a given number of nodes N, the SBM takes as parameter a partition 
a vector of group membership, attributing one of a C different communities to each
and a 
adjacency matrix

degree sequence 

which randomly generates graphs that comport communities based on a few parameters: a number of nodes, of communities and a probability of connection between nodes from these communities. 
REF BM FIRST STEP
GOOD DEFINITION SBM WITH SYMBOLS 

As we already have a graph, we want instead the probability that it was generated by a given partition.
REF

BAYES FORMULA 

Using bayesian inference, this is analogous to evaluating the posterior probability of noticing a particular grouping of nodes from the graph. 

Moreover 
dont have set number of groups of diseases 
should be derive from data 
 number of groups should also be obtained from the data, possible when using non-parametric inference.
REF
Number group hyperparameter of model, to avoid having similar number of nodes in all groups sample distribution of group size from number of groups, then sample partitions

integrated in prior calculation
REF Bayesian 

Other prior: infer edge distribution from partition. If the model is degree corrected: degree sequence= MORE DETAIL
infer it from the 


PUT PRIOR FORMULA


microcanonical version of SBM; model parameters correspond to hard constraint: small change would lead to a different generated graph, resulting in a zero probability for the given graph. Also has computational advantages, since computing the joint and marginal probabilities is now the same. 


The use of a generative probabilistic technique helps to distinguish communities from statistical noise contrary to many heuristic ones. 

The same methodology has been applied in the field of topic modeling with promising results 
REF



start SBM of a graph, modify partition so that probability it generated the graph was maximum

sample values using MCMC hamilton 



minimum description length
find simplest partition that generated it


description length amount of info to describe data, the likelihood of found partition giving rise to the given data
minimising this value equivalent to opting for the simplest model, one that will 
completely randomly generated graphs should not give rise to communities 

no overfitting/ underfitting 
(ref paper)

DEMOGRAPHICS
but also the demographic characteristics of the patients, should lead to range of different connection patterns from the diseases

grouping the diseases by the similarity of their relation 

alternative way classification: mathematical
community of networks 


classification 

bring surprising groups of diseases, different from usual classification, 
different factors

task regroup nodes more densely connected together 

community: locally dense connected subgraph 

community finding


sbm is symmetric, also group patients at the same time, if had more data could find hidden factors between patients from different demographics


https://academic.oup.com/eurpub/article/29/1/182/5033670

maybe this https://www.researchgate.net/profile/Marzouki-Faouzi/publication/341400450_Multi-morbidity_Analysis_using_Community_Detection_Approach_a_Comparative_study/links/5ec854fda6fdcc90d68fa7a1/Multi-morbidity-Analysis-using-Community-Detection-Approach-a-Comparative-study.pdf





community detection

http://www.princeton.edu/~eabbe/publications/abbe_FNT_2.pdf 
intro this paper 
https://appliednetsci.springeropen.com/track/pdf/10.1007/s41109-019-0232-2.pdf

talk on community


https://arxiv.org/pdf/1610.02703v4.pdf

Nonparametric Bayesian inference microcano SBM

many methods for community detection, SBM based on bayesian inference is robust  


(its a copy paste, change it)
Due to its nonparametric Bayesian nature, the number of topics in each category, as well as the shape and depth of the hierarchy, are automatically determined from the posterior distribution according to the statistical evidence available, avoiding both overfitting and underfitting.



microcanonical 


derive number of groups 



what is a community 
clique ? too strict 


other applications stochatib block model for classifications
TOPIC MODELLING 


talk on sbm 

inference 

bayes 

flat sbm 

nested sbm 

layered 
https://arxiv.org/pdf/1310.4377.pdf
https://topsbm.github.io




multimorbidity: not studied enough, could use progress in network analysis 






from bayes
want to find the most likely distribution of the parameters of the models explaining the data. 

MCMC to sample values from the posterior 
https://towardsdatascience.com/from-scratch-bayesian-inference-markov-chain-monte-carlo-and-metropolis-hastings-in-python-ef21a29e25a

https://twiecki.io/blog/2015/11/10/mcmc-sampling/

https://towardsdatascience.com/mcmc-intuition-for-everyone-5ae79fff22b1

MCMC
monte carlo 
relies on generation of random numbers
based on a given distribution

markov chains 
where newly drawn values depend on the previous ones. 

metropolis hastings
which proposed value of teta to accept or reject

nested SBM

layered SBM





EXPLAIN WHAT IVE DONE AS WELL TOO 



talk about the library graphtool 

describe the full methodology

create graph
add nodes/edges
all parts

research papers
try understand them
research community finding
get used to library
discover dataset
work on dice 



The data used is derived from the MIMIC-III database, which comport a broad range of information on patients admitted a Medical center in Boston, Massaschussets.
Our specific dataset comports 56115 entries of patient admissions associated with a patient ID. 
Demographics informations are available for each patients, their gender(male or female), their ethnicity amongst 7 possible categories and their age group.
Finally the ICD-9 codes of the diseases affecting each patient during his admission 


Methodologyh 

Make graphs, using graphtool
create node for each demographic element (e.g: one for male and female genders), one for each patient node, create an edge between the node and each of the demographic characteristic, if they have a specific disease create specific node for that disease if it does not exist already, and link them. 


turned into graphs 
various experiments to evaluate 

add layer for demographics
tripartite graph

different types of connections between patients and diseases along with the demographic categories are taken into account 
weight given to 